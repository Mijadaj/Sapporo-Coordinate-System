<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="大札幌座標系">
    <meta name="twitter:image" content="画像のURL">
    <title>計算式 | 大札幌座標系</title>
    <link rel="icon" href="./images/hokkaido.webp"/>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/style.css">
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <a href="./index.html" class="headerLink">
        <header>
            <img src="./images/hokkaido.webp" alt="An image of Hokkaido" />
            <h1>大札幌座標系</h1>
            <p>札幌の住所表記「北X条東Y丁目」を全球的に拡張．</p>
        </header>
    </a>
    <p>以下、道内各市街地の碁盤の目を基準とした測地基準系を <b>HGS</b> (Hokkaido Geodetic Systems) と呼ぶことにする。</p>
    <h2>WGS から HGS への座標変換</h2>
    <p>
        <b>WGS84</b> における地心直交座標を \((x, y, z)\), 緯度経度を \((\phi, \lambda)\), <b>HGS</b> における直交座標を \((X, Y, Z)\), 緯度経度を \((\Phi, \Lambda)\) で表す。最終的に求める条丁目は HGS の経緯度のみで決定し、楕円体高はすべて \(h = 0\) して考える。このとき、測地基準系 HGS を以下のように定義する。
    </p>
    <p>\[
        \begin{array}{ll}
        \begin{bmatrix}X \\ Y \\ Z\end{bmatrix}
        &= R_x(-\delta) R_y(\phi_o') R_z(-\lambda_o) \begin{bmatrix}x \\ y \\ z\end{bmatrix} \\
        &= R_x(-\delta) R_y(\phi_o') R_z(-\lambda_o) \begin{bmatrix}N \cos \phi \cos \lambda \\ N \cos \phi\sin \lambda\\ (1 - e^2) N \sin \phi \end{bmatrix}
        \end{array}
        \]
    </p>
    <p>\[
        \begin{eqnarray}\left\{ \begin{array}{ll}
        \Phi &= \sin^{-1} \dfrac{Z}{\sqrt{X^2 + Y^2 + Z^2}} \\
        \Lambda &= \mathrm{sgn} (Y) \cos^{-1} \dfrac{X}{\sqrt{X^2 + Y^2}}
        \end{array}\right.\end{eqnarray}
    \]</p>
    <p>ただし、\[
        \begin{array}{ll}
        \mathrm{O} (\phi_o , \lambda_o)&:&\text{HGS 経緯度原点の WGS 座標}\\
        \phi_o'&:&\text{地点Oにおける地心緯度}\\
        \delta &:&\text{真北に対する HGS 本初子午線の偏角（西偏を正とする）} \\
        e&:&第一離心率\\
        N&:& 卯酉線曲率半径\\
        R_x(\theta), R_y(\theta), R_z(\theta)&:& x軸, y軸, z軸\text{まわりの回転行列（反時計回りが正）}
        \end{array}
    \]</p>
    <p>札幌座標系を例に考えれば、\(O (\phi_o, \lambda_o)\) は大通と創成川の交点の座標「北緯43度3分40.10秒 東経141度21分25.48秒」に対応し、\(\delta\) は真北に対する創成川の傾きである「西偏 10.5842138889 度」に対応する。</p>
    <p>\((\Phi, \Lambda)\) から条丁目への変換は、あらかじめ定義された1区画あたりの緯度差\(\mathit{\Delta} \Phi\), 経度差 \(\mathit{\Delta} \Lambda\) にもとづいている。</p>
    <p>\[
        \mathit{\Delta} \Phi = 
    \]</p>
    <h2>HGS から WGS への座標変換</h2>
    <p>上記の回転行列の逆行列 \(R_z(\lambda_o) R_y(-\phi_o') R_x(\delta) \) を用いる。</p>
</body>